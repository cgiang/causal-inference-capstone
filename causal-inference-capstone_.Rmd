---
title: "What is the causal effect of sleeping time on well-being?"
author: "Charlotte Giang, Yunyang Zhong"
date: "10/11/2020"
output: html_document
---

```{r}
library(ipumsr)
ddi <- read_ipums_ddi("atus_00001.xml")
data <- read_ipums_micro(ddi)
```

```{r}
mod1 <- lm(WB_RESP~Sleeping_time, data = data)
summary(mod1)
```


```{r}
# WHAT DOES THIS DO?

testImplications <- function( covariance.matrix, sample.size ){
	library(ggm)
	tst <- function(i){ pcor.test( pcor(i,covariance.matrix), length(i)-2, sample.size )$pvalue }
tos <- function(i){ paste(i,collapse=" ") }
implications <- list(c("Well-being","Spouse or unmarried partner in household","Person weight","Sleeping_time"),
		c("Well-being","Family income","Person weight","Sleeping_time"),
		c("Well-being","Employment status (spouse or partner)","Family income","Spouse or unmarried partner in household"),
		c("Well-being","Employment status (spouse or partner)","Person weight","Sleeping_time"),
		c("Well-being","Highest level of school completed (spouse or partner)","Family income","Spouse or unmarried partner in household"),
		c("Well-being","Highest level of school completed (spouse or partner)","Person weight","Sleeping_time"),
		c("Person weight","Spouse or unmarried partner in household"),
		c("Person weight","Family income"),
		c("Person weight","Employment status (spouse or partner)"),
		c("Person weight","Highest level of school completed (spouse or partner)"),
		c("Life satisfaction","Sleeping_time","Well-being","Spouse or unmarried partner in household","Family income","Person weight"),
		c("Life satisfaction","Employment status (spouse or partner)","Family income","Spouse or unmarried partner in household"),
		c("Life satisfaction","Highest level of school completed (spouse or partner)","Family income","Spouse or unmarried partner in household"),
		c("Sleeping_time","Employment status (spouse or partner)","Family income","Spouse or unmarried partner in household"),
		c("Sleeping_time","Highest level of school completed (spouse or partner)","Family income","Spouse or unmarried partner in household"),
		c("Spouse or unmarried partner in household","Highest level of school completed (spouse or partner)"))
	data.frame( implication=unlist(lapply(implications,tos)),
		pvalue=unlist( lapply( implications, tst ) ) )

}
```

![](dag2.png)

Adjustment, total effect: Family income, Spouse or unmarried partner in household
Adjustment, direct effect: Family income, Person weight, Spouse or unmarried partner in household, Well-being

```{r, echo=FALSE, message=FALSE}
library(dagitty)
dag <- dagitty("dag {
bb=\"0,0,1,1\"
\"Employment status (spouse or partner)\" [pos=\"-0.4,0.3\"]
\"Family income\" [pos=\"-0.307,0.522\"]
\"Highest level of school completed (spouse or partner)\" [pos=\"-0.122,0.392\"]
\"Household elderly care\" [pos=\"0.137,0.841\"]
\"Life satisfaction\" [outcome,pos=\"-0.112,1.103\"]
\"Person weight\" [pos=\"-1.014,0.756\"]
\"Spouse or unmarried partner in household\" [pos=\"-0.801,0.599\"]
\"Traveling time\" [pos=\"-0.001,0.596\"]
\"Well-being\" [pos=\"-0.584,1.012\"]
\"Sleeping_time\" [exposure,pos=\"-1.108,1.101\"]
\"Employment status (spouse or partner)\" -> \"Family income\"
\"Family income\" -> \"Household elderly care\"
\"Family income\" -> \"Life satisfaction\"
\"Family income\" -> \"Traveling time\"
\"Family income\" -> \"Sleeping_time\"
\"Highest level of school completed (spouse or partner)\" -> \"Employment status (spouse or partner)\"
\"Highest level of school completed (spouse or partner)\" -> \"Family income\"
\"Household elderly care\" -> \"Life satisfaction\"
\"Household elderly care\" -> \"Traveling time\"
\"Person weight\" -> \"Life satisfaction\"
\"Person weight\" -> \"Well-being\"
\"Spouse or unmarried partner in household\" -> \"Employment status (spouse or partner)\"
\"Spouse or unmarried partner in household\" -> \"Family income\"
\"Spouse or unmarried partner in household\" -> \"Household elderly care\"
\"Spouse or unmarried partner in household\" -> \"Life satisfaction\"
\"Spouse or unmarried partner in household\" -> \"Traveling time\"
\"Spouse or unmarried partner in household\" -> \"Sleeping_time\"
\"Traveling time\" -> \"Life satisfaction\"
\"Well-being\" -> \"Life satisfaction\"
\"Sleeping_time\" -> \"Life satisfaction\"
\"Sleeping_time\" -> \"Person weight\"
\"Sleeping_time\" -> \"Well-being\"
}
")
plot(dag)
```


```{r}
# WHAT DOES THIS DO?

testImplications <- function( covariance.matrix, sample.size ){
	library(ggm)
	tst <- function(i){ pcor.test( pcor(i,covariance.matrix), length(i)-2, sample.size )$pvalue }
tos <- function(i){ paste(i,collapse=" ") }
implications <- list(c("Well-being","Spouse or unmarried partner in household","Sleeping_time"),
		c("Well-being","Family income","Sleeping_time"),
		c("Well-being","Employment status (spouse or partner)","Family income","Spouse or unmarried partner in household"),
		c("Well-being","Employment status (spouse or partner)","Sleeping_time"),
		c("Well-being","Highest level of school completed (spouse or partner)","Family income","Spouse or unmarried partner in household"),
		c("Well-being","Highest level of school completed (spouse or partner)","Sleeping_time"),
		c("Well-being","Household elderly care","Family income","Spouse or unmarried partner in household"),
		c("Well-being","Household elderly care","Sleeping_time"),
		c("Well-being","Traveling time","Spouse or unmarried partner in household","Family income"),
		c("Well-being","Traveling time","Sleeping_time"),
		c("Person weight","Spouse or unmarried partner in household","Sleeping_time"),
		c("Person weight","Family income","Sleeping_time"),
		c("Person weight","Employment status (spouse or partner)","Family income","Spouse or unmarried partner in household"),
		c("Person weight","Employment status (spouse or partner)","Sleeping_time"),
		c("Person weight","Highest level of school completed (spouse or partner)","Family income","Spouse or unmarried partner in household"),
		c("Person weight","Highest level of school completed (spouse or partner)","Sleeping_time"),
		c("Person weight","Household elderly care","Family income","Spouse or unmarried partner in household"),
		c("Person weight","Household elderly care","Sleeping_time"),
		c("Person weight","Traveling time","Spouse or unmarried partner in household","Family income"),
		c("Person weight","Traveling time","Sleeping_time"),
		c("Life satisfaction","Employment status (spouse or partner)","Family income","Spouse or unmarried partner in household"),
		c("Life satisfaction","Highest level of school completed (spouse or partner)","Family income","Spouse or unmarried partner in household"),
		c("Sleeping_time","Employment status (spouse or partner)","Family income","Spouse or unmarried partner in household"),
		c("Sleeping_time","Highest level of school completed (spouse or partner)","Family income","Spouse or unmarried partner in household"),
		c("Sleeping_time","Household elderly care","Family income","Spouse or unmarried partner in household"),
		c("Sleeping_time","Traveling time","Spouse or unmarried partner in household","Family income"),
		c("Spouse or unmarried partner in household","Highest level of school completed (spouse or partner)"),
		c("Employment status (spouse or partner)","Household elderly care","Family income","Spouse or unmarried partner in household"),
		c("Employment status (spouse or partner)","Traveling time","Spouse or unmarried partner in household","Family income"),
		c("Highest level of school completed (spouse or partner)","Household elderly care","Family income","Spouse or unmarried partner in household"),
		c("Highest level of school completed (spouse or partner)","Traveling time","Spouse or unmarried partner in household","Family income"))
	data.frame( implication=unlist(lapply(implications,tos)),
		pvalue=unlist( lapply( implications, tst ) ) )

}
```
